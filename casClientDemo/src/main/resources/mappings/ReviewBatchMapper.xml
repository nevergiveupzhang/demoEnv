<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.pms.dataService.dao.ReviewBatchDao">
    <select id="getReviewBatchListByUserId" resultMap="ReviewBatch">
        select
        rbh.*
        from
        review_batch rbh
        inner join review_batch_eperson_relation rber on rber.reviewBatchId = rbh.reviewBatchId
        and rber.epersonId = #{userId}
        <trim prefix="WHERE" prefixOverrides="AND|OR">
            <if test="review != null and review != ''">
                and rbh.review like concat(concat('%',#{review}),'%')
            </if>
            <if test="beginDate != null and beginDate != ''">
                <![CDATA[ and rbh.beginDate >= #{beginDate} ]]>
            </if>
            <if test="endDate != null and endDate != ''">
                <![CDATA[ and rbh.endDate <= #{endDate} ]]>
            </if>
            <if test="status != null">
                and rbh.status = #{status}
            </if>
            <if test="style != null">
                and rbh.style = #{style}
            </if>
            and rbh.state = 0
        </trim>
        ORDER BY rbh.createTime DESC
    </select>
</mapper>